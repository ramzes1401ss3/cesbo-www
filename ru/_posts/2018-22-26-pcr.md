---
layout: post
lang: ru
title: PCR error
tags: [dev]
---

Если при приеме потока MPTS или SPTS у вас возникает подергивание картинки или другие подобные артефакты наиболее вероятная причина является проблема с PCR. 

<!-- more -->

Варианты с проблемой в канале передачи данных в данной заметке мы не рассматриваем. Дело в том, что при генерации MPTS/SPTS потока компьютером очень трудно(почти не реально) выдержать предписываемые стандартом значения в 500нсек.

Согласно стандарту различаются два вида PCR ошибок потока:  

 - PCR_error — возникает если интервал между временными метками более 40мс;

 - PCR_accuracy_error – возникает если при приеме PCR обнаруживается ошибка по фазе более 500 нс.

Определены следующие составляющие джиттера:  

 - Отклонение частоты (PCR_FO)
 - Дрейф (PCR_DR)
 - Общий джиттер (PCR_OJ)
 - Точность программных тактов (PCR_AC).
Отклонение частоты (PCR_FO) определяется как разница между переданной частотой программных тактов и номинальной тактовой частотой. Допустимое отклонение определяется в ИСО/IEC13818-1 и соответствует — ±810 Гц или ±30 ppm.  

Дрейф (PCR_DR) определяется как первая производная частоты и измеряется на компонентах низкой частоты программных тактов, при помощи разницы между переданной частотой программных тактов и номинальной частотой тактов. Допустимое отклонение определено в ИСО/IEC 13818-1 и составляет ±75 мГц/с или ±10 ppm/ час.  

Общий джиттер (PCROJ) определяется как мгновенное изменение компонентов высокой частоты, т.е. это разница между тем, когда PCR должен прибыть в точку измерения, и тем, когда он прибыл фактически. Измеренное значение параметра PCROJ выражается в наносекундах.  

Измерение PCR_OJ разработано для учета всех совокупных ошибок, влияющих на значения PCR в течение генерации программного потока, мультиплексирования, передачи, и т.п. Все эти воздействия проявляются как джиттер на входе приемника, но все они являются комбинацией неточностей PCR и джиттера при передаче. Поэтому допустимое значение может быть сравнимо с максимальной ошибкой, определенной в ISO/IEC 13818-1 как точность PCR, равной ±500 нс, при том условии, что джиттер при передаче принимается равным нулю.  

Точность PCR (PCRAC) — определяется как разница между фактическим значением PCR и величиной, которая должна быть в транспортном потоке, представляемая байтовым индексом для своей фактической позиции. Она может быть вычислена для постоянной скорости транспортного потока. Измеренное значение параметра PCRAC выражается в наносекундах. Допустимое значение определено в ISO/IEC 13818-1 и составляет: ±500 нс.  