---
layout: post
lang: ru
title: Формат адреса передачи
tags: [dev]
---

Медиа-адрес состоит из трех частей:
`type://address#options`  

<!-- more -->
#### type

Описывает, какой тип передачи следует использовать. Доступны следующие типы:  

- **udp** — UDP мультикаст, юникаст или броадкаст    
- **rtp** — протокол, основанный на UDP  
- **http** — HTTP-протокол. MPEG-TS, HLS (потоковое видео HTTP)  
- **resi** — отправка данных на модулятор DVB-C  
- **file** — MPEG-TS файлы  
- **np** — NetworkPush - это протокол, основанный на HTTP. служит для отправки потоков на сервер   

#### address

Адрес источника

#### options

Параметры могут быть специальными и общими. Параметры должны делиться символом &. Например:

`resi://#adapter=0&frequency=346&modulation=QAM256`  

### UDP/RTP

`udp://[interface@]address[:port]`  
`rtp://[interface@]address[:port]`  
- **interface** — IPv4 адрес или имя локального интерфейса. По умолчанию используется таблица маршрутизации.
- **address** — IPv4 адрес потока. Мультикаст или юникаст.  
- **port** — port number. По умолчанию: 1234  
Дополнительные параметры:

- **ttl=TTL** — время жизни UDP пакета. По умолчанию:: 32  
- **no_sync** — синхронизация потока - это равномерная передача потока на основе метки PCR. Astra вычисляет общий размер блока между двумя метками PCR и фактической скоростью блока. Этот параметр отключает эту функцию.  
- **cbr=RATE** — добавить  NULL-TS пакеты в поток, чтобы получить постоянный битрейт. Значение должно быть в KBit/s  
Пример:  

`udp://239.255.1.1:1234` 
`udp://eth0@239.255.1.1`  
`udp://239.255.1.1:1234#cbr=8000`  

### HTTP

`http://interface:port[/path]`  
- **interface** — адрес локального интерфейса или **0** для приема соединения с любого интерфейса  
- **port** — номер порта. По умолчанию: 80
- **path** — путь к ресурсу. Для использования HLS в конце пути должно быть /index.m3u8 о умолчанию: /
Дополнительные параметры HLS потока:

- **duration=5** — длина сегмента в секундах. По умолчанию: 5  
- **quantity=6** — количество сегментов. По умолчанию: 6
- **no_auth** — доступ к потоку без аутентификации
Дополнительные параметры MPEG-TS потока:  

- **buffer_size=SIZE** — размер в килобайтах клиентского буфера. Буфер выделяется для каждого соединения и предотвращает потерю данных при задержках передачи. По умолчанию:: 1024
- **buffer_fill=SIZE** — минимальный размер данных в килобайтах, который должен быть собран перед передачей клиенту. По умолчанию: 256  
- **no_auth** — доступ к потоку без аутентификации  
Пример:

`http://0:10000/channel-id/index.m3u8#no_auth` — передача HLS  
`http://0:10000/channel-id — MPEG-TS stream`  

### RESI

RESI — это модулятор DVB-C производства компании DigitalDevices

`resi://#adapter=0&device=0&frequency=346&modulation=QAM256`
Опции:

- **adapter** — номер адаптера RESI в системе: /dev/dvb/adapter0
- **device** — номер модулятора в адаптере RESI: /dev/dvb/adapter0/mod0
- **frequency** — частота транспондера
- **symbolrate** — скорость транспондера. По умолчанию: 6900
- **modulation** — DVB-C модуляция. возможные значения: QAM16, QAM32, QAM64, QAM128, QAM256. Default: QAM64
- **attenuator** — Аттеньюация уровня сигнала. Значение должно находиться в диапазоне от 0 до 10. По умолчанию: 0

### MPEG-TS File

`file://path`
- **path** — путь до файла
Пример:

`file:///mnt/raid0/file.ts`

### Network Push

Network Push — протокол передачи потоков на основе HTTP. Используется для передачи потоков от клиента на сервер.  Например для передачи потока на сервера для транскодирования  

`np://[login:password@]address[:port][/path]`
- **login:password** — — логин и пароль для HTTP-авторизации. Поддерживает: Basic, Digest. For Input only!  
- **address** — — IPv4 адрес или доменное имя хоста  
- **port** — номер порта. По умолчанию: 80
- **path** — путь к ресурсу. По умолчанию: /

Дополнительные параметры для Output:  

- **sctp** — использовать протокол SCTP вместо TCP

Пример:  

`np://media.example.com/channel-id`

