---
layout: post
lang: ru
title: MPEG-TS
tags: [dev]
---

## MPEG-TS

<!-- more -->

### PID - TS Packet identifier


SPTS потоки (видео, аудио) и информационные таблицы упаковываются в TS-пакеты. Каждый пакет имеет уникальный идентификатор - PID.    
Значение PID должно находиться в диапазоне от 0 до 8191. Диапазон от 0 до 31 и 8191 зарезервирован и не должен использоваться для SPTS. Для SPTS можно использовать любой PID в диапазоне от 32 до 8190.  

#### Как найти значения PID в потоке?
- С помощью VLC player. запустите воспроизведение потока, затем откройте Tools - Media Information - Codec. Поле «Original ID» содержит значение PID
- С помощью Astra analyzer. Выполните в консоли:
`astra --analyze "stream address`

### CBR/VBR - битрейт

Битрейт потока имеет два типа:

- **VBR** - переменный битрейт, зависит от степени сжатия потока
- **CBR** - постоянный битрейт, это поток VBR, заполненный пакетами NULL-TS
NULL-TS имебт постоянный PID - 8191 и не имеют полезной нагрузки, только нули.

Чтобы генерировать потоки CBR в Astra, добавьте параметр cbr в выходной адрес. Значение должно быть в Кбит/с. Например:

`udp://239.255.1.1:1234#cbr=8000`  
Примечание: опция **`no_sync`** отключает CBR
Для версий ниже 5.63 - опция CBR должна использоваться в сочетании с опцией **`sync`**

Если поток битрейт превышает значение **`cbr`**, поток передается как есть. Опция работает только для UDP-выхода. Для любых других форматов выхода нет необходимости использовать CBR.
